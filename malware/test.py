import os

import numpy as np
import tensorflow as tf
from encoder import encode_pe

file = os.path.join("Advanced_IP_Scanner_2.5.3850.exe")

path_model = os.path.join("results/malware.h5")
model = tf.keras.models.load_model(path_model, compile=False)
encoded = encode_pe(file)
encoded = [float(x) for x in encoded]
print(model.predict(np.array([encoded])))
